beer<-scan("beer.txt")
plot.ts(beer, type="b", main="Beer Production in Australia")
# Check for season
par(mfrow=c(4,1))
plot.ts(diff(beer,1), main="First Difference (Non-Seasonal)")
plot.ts(diff(beer,2), main="2nd Difference (Non-Seasonal)")
plot.ts(diff(beer,5), main="3rd Difference (Non-Seasonal)")
plot.ts(diff(beer,4), main="Fourth Difference (Seasonal)")
#Plot new
plot.ts(diff(diff(beer),4), main="Time Series Plot with both non-seasonal and seasonal diff")
# Chose order
par(mfrow=c(2,1))
acf(diff(diff(beer),4),16, main="ACF with both differencing")
pacf(diff(diff(beer),4),16, main="PACF with both differencing")
# Model diagnostics
source("sarima.R")
fit1<-sarima(beer,2,1,0,0,1,2,4) ##ok. barely sig acf at lag 9
#fit1<-sarima(beer,2,1,0,0,1,2,4) ##ok. barely sig acf at lag 9
fit2<-sarima(beer,0,1,1,0,1,2,4) ##pvalue not good
fit3<-sarima(beer,1,1,1,0,1,2,4) ##ok
fit4<-sarima(beer,2,1,1,0,1,2,4) #ok
fit5<-sarima(beer,2,1,3,0,1,2,4) #ok
fit6<-sarima(beer,0,1,3,0,1,2,4) #ok
fit7<-sarima(beer,0,1,0,0,1,2,4) #no good
# Model selection
fit3
fit4
# Forecast
sarima.for(beer,12,1,1,1,0,1,2,4)
# Forecast
fitit = arima(beer, order=c(1,1,1), seasonal=list(order=c(0,1,2), period=4)
arima.forecast(12)
predict(fitit,12)
# Forecast
# Forecast
fitit = arima(beer, order=c(1,1,1), seasonal=list(order=c(0,1,2), period=4))
predict(fitit,12)
predict(fit3,12)
beer
plot.ts(beer, type="b", main="Beer Production in Australia")
plot.ts(predict(fit_best,12))
# Forecast
fit_best = arima(beer, order=c(1,1,1), seasonal=list(order=c(0,1,2), period=4))
plot.ts(predict(fit_best,12))
predict(fit_best,12)
beer<-scan("beer.txt")
plot.ts(beer, type="b", main="Beer Production in Australia")
# Check for season
par(mfrow=c(4,1))
plot.ts(diff(beer,1), main="First Difference (Non-Seasonal)")
plot.ts(diff(beer,2), main="2nd Difference (Non-Seasonal)")
plot.ts(diff(beer,5), main="3rd Difference (Non-Seasonal)")
plot.ts(diff(beer,4), main="Fourth Difference (Seasonal)")
#Plot new
plot.ts(diff(diff(beer),4), main="Time Series Plot with both non-seasonal and seasonal diff")
# Chose order
par(mfrow=c(2,1))
acf(diff(diff(beer),4),16, main="ACF with both differencing")
pacf(diff(diff(beer),4),16, main="PACF with both differencing")
